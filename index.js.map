{"version":3,"file":"index.js","sources":["../src/js/init.js","../src/main.js"],"sourcesContent":["window.global ||= window;","import './js/init';\r\nimport iziToast from 'izitoast';\r\nimport 'izitoast/dist/css/iziToast.min.css';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\nimport SimpleLightbox from 'simplelightbox';\r\nimport axios from 'axios';\r\n\r\nconst baseUrl = 'https://pixabay.com/api/?';\r\nconst API_KEY = '48318006-868fd1918e5aa19d98c3706e2';\r\n\r\nconst searchParams = new URLSearchParams({\r\n  key: API_KEY,\r\n  q: '',\r\n  image_type: 'photo',\r\n  orientation: 'horizontal',\r\n  safesearch: true,\r\n  per_page: 40,\r\n  page: 1,\r\n});\r\n\r\nlet totalHits = 0;\r\nconst message1 = \"Sorry, there are no images matching your search query.Please, try again!\";\r\nconst message2 = \"We're sorry, but you've reached the end of search results\";\r\nconst contentUL = document.querySelector('.image-content');\r\nconst loader = document.querySelector('.loader');\r\nconst loadMore = document.querySelector('.load-more-button');\r\n\r\nfunction scrollPage(){\r\n  let listItems = document.querySelector('.content-list-item');\r\n  let rect = listItems.getBoundingClientRect();\r\n  window.scrollBy({top: rect.height*2, behavior: 'smooth',});\r\n}\r\n\r\n// showing error using izitoast\r\nfunction showError(errorMessage, bgcolor) {\r\n  iziToast.settings({\r\n    timeout: 5000,\r\n    transitionIn: 'flipInX',\r\n    transitionOut: 'flipOutX',\r\n  });\r\n  iziToast.show({\r\n    maxWidth: '350px',\r\n    message: `${errorMessage}`,\r\n    position: 'topRight',\r\n    backgroundColor: `${bgcolor}`,\r\n  });\r\n}\r\n\r\n// creates the image gallery given the jsonData\r\nfunction createMarkup(jsonData) {\r\n  const contentMarkup = jsonData.hits\r\n    .map(\r\n      ({\r\n        webformatURL,\r\n        largeImageURL,\r\n        tags,\r\n        likes,\r\n        views,\r\n        comments,\r\n        downloads,\r\n      }) =>\r\n        `<li class=\"content-list-item\">\r\n            <div class=\"container-div\">\r\n                <a href=\"${largeImageURL}\">\r\n                    <img src=\"${webformatURL}\" alt=\"${tags}\" width=\"240\" height=\"200\">\r\n                </a>\r\n                <div class=\"content-bottom\">\r\n                    <div class=\"content-bottom-inner\">\r\n                        <p><b>Likes</b></p>\r\n                        <p class=\"stats\">${likes}</p></div>\r\n                    <div class=\"content-bottom-inner\">\r\n                        <p><b>Views</b></p>\r\n                        <p class=\"stats\">${views}</p></div>\r\n                    <div class=\"content-bottom-inner\">\r\n                        <p><b>Comments</b></p>\r\n                        <p class=\"stats\">${comments}</p></div>\r\n                    <div class=\"content-bottom-inner\">\r\n                        <p><b>Downloads</b></p>\r\n                        <p class=\"stats\">${downloads}</p></div>\r\n                </div> \r\n            </div> \r\n        </li>`\r\n    )\r\n    .join('');\r\n\r\n  contentUL.innerHTML += contentMarkup;\r\n  const mylightbox = new SimpleLightbox('.content-list-item a', {\r\n    captionsData: 'alt',\r\n    captionDelay: 250,\r\n  });\r\n}\r\n\r\nasync function getData() {\r\n  try {\r\n    const response = await axios.get(baseUrl, { params: searchParams });\r\n    loader.style.display = 'none';\r\n    loadMore.style.display = 'none';\r\n    totalHits = response.data.totalHits;\r\n    if (totalHits === 0) {\r\n      showError(message1, 'red');\r\n    } \r\n    else {\r\n      createMarkup(response.data);\r\n\r\n      const currentPage = Number(searchParams.get('page'));\r\n      const perPage = Number(searchParams.get('per_page'));\r\n\r\n      if (currentPage < Math.ceil(totalHits / perPage)) {\r\n        loadMore.style.display = 'block';\r\n      }\r\n      if (Math.ceil(totalHits / perPage) === 1){\r\n        showError(message2, \"aqua\");\r\n      }\r\n    }\r\n  } catch (error) {\r\n    loader.style.display = 'none';\r\n    showError(error, \"purple\");\r\n  }\r\n}\r\n\r\nconst searchForm = document.querySelector('.search-form');\r\nconst searchInput = document.querySelector('.search-input');\r\n\r\nsearchForm.addEventListener('submit', event => {\r\n  event.preventDefault();\r\n  searchParams.set('q', searchInput.value);\r\n  searchParams.set('page', '1');\r\n  // empty the inside of gallery ul\r\n  contentUL.innerHTML = '';\r\n  // lets make the loader visible first\r\n  loader.style.display = 'flex';\r\n  getData();\r\n});\r\n\r\nloadMore.addEventListener('click', async (event) => {\r\n  // increment the page number\r\n  let currentPage = Number(searchParams.get('page'));\r\n  let perPage = searchParams.get('per_page');\r\n  searchParams.set('page', currentPage + 1);\r\n\r\n  await getData();\r\n  scrollPage();\r\n  \r\n  if (currentPage+1 >= Math.ceil(totalHits / perPage)) {\r\n    showError(message2, 'aqua');\r\n    loadMore.style.display = 'none';\r\n  }\r\n});\r\n"],"names":["baseUrl","API_KEY","searchParams","totalHits","message1","message2","contentUL","loader","loadMore","scrollPage","rect","showError","errorMessage","bgcolor","iziToast","createMarkup","jsonData","contentMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","getData","response","axios","currentPage","perPage","error","searchForm","searchInput","event"],"mappings":"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"}